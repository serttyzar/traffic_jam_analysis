# Traffic Jam Analysis with YOLOv8 and ByteTrack

–ú–æ–¥—É–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏–∑–∞ –¥–æ—Ä–æ–∂–Ω—ã—Ö –ø—Ä–æ–±–æ–∫ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **YOLOv8** –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ –∏ **ByteTrack** –¥–ª—è —Ç—Ä–µ–∫–∏–Ω–≥–∞ –æ–±—ä–µ–∫—Ç–æ–≤. –ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é –æ—Ü–µ–Ω–∫—É —Ç—Ä–∞—Ñ–∏–∫–∞ –ø–æ 10-–±–∞–ª–ª—å–Ω–æ–π —à–∫–∞–ª–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏, —Å–∫–æ—Ä–æ—Å—Ç–∏, –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ–±—ä–µ–∫—Ç–æ–≤ –∏ –¥—Ä—É–≥–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –≤–∏–¥–µ–æ, –≤–∫–ª—é—á–∞—è –∑–∞–≥—Ä—É–∑–∫—É —Å YouTube —á–µ—Ä–µ–∑ `yt-dlp`.

---

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–î–µ—Ç–µ–∫—Ü–∏—è –∏ —Ç—Ä–µ–∫–∏–Ω–≥ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞**
  - YOLOv8 ‚Äî —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è, —Ç–æ—á–Ω–∞—è –∏ –±—ã—Å—Ç—Ä–∞—è –º–æ–¥–µ–ª—å –¥–µ—Ç–µ–∫—Ü–∏–∏ –æ–±—ä–µ–∫—Ç–æ–≤, –æ–±—É—á–µ–Ω–Ω–∞—è –Ω–∞ COCO –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∞—è –∫–ª–∞—Å—Å—ã: –∞–≤—Ç–æ–º–æ–±–∏–ª—å, –∞–≤—Ç–æ–±—É—Å, –º–æ—Ç–æ—Ü–∏–∫–ª, –≥—Ä—É–∑–æ–≤–∏–∫ –∏ –¥—Ä.
  - ByteTrack ‚Äî —Ç—Ä–µ–∫–µ—Ä, —Å–ø–æ—Å–æ–±–Ω—ã–π —É—Å—Ç–æ–π—á–∏–≤–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç—ã –º–µ–∂–¥—É –∫–∞–¥—Ä–∞–º–∏, –¥–∞–∂–µ –ø—Ä–∏ –∫—Ä–∞—Ç–∫–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–µ—Ä–µ–∫—Ä—ã—Ç–∏—è—Ö –∏–ª–∏ –ø—Ä–æ–ø—É—Å–∫–∞—Ö
- **–û—Ü–µ–Ω–∫–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ 10-–±–∞–ª–ª—å–Ω–æ–π —à–∫–∞–ª–µ**, –æ—Å–Ω–æ–≤–∞–Ω–Ω–æ–π –Ω–∞:
  - –ü–ª–æ—Ç–Ω–æ—Å—Ç–∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ –≤ ROI (–æ–±–ª–∞—Å—Ç–∏ –∏–Ω—Ç–µ—Ä–µ—Å–∞)
  - –ö–æ–ª–∏—á–µ—Å—Ç–≤–µ –æ–±—ä–µ–∫—Ç–æ–≤
  - –°—Ä–µ–¥–Ω–µ–π —Å–∫–æ—Ä–æ—Å—Ç–∏
  - –î–∏—Å–ø–µ—Ä—Å–∏–∏ —Å–∫–æ—Ä–æ—Å—Ç–µ–π
  - –î–æ–ª–µ –Ω–µ–ø–æ–¥–≤–∏–∂–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
- **–°–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫** ‚Äî —Å–∫–æ–ª—å–∑—è—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ –ø–æ 50 –∫–∞–¥—Ä–∞–º –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π
- **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è**:
  - ROI (–∂—ë–ª—Ç–∞—è —Ä–∞–º–∫–∞, 90% –∫–∞–¥—Ä–∞)
  - Bounding box'—ã: –∑–µ–ª—ë–Ω—ã–µ (–≤–Ω—É—Ç—Ä–∏ ROI), —Å–µ—Ä—ã–µ (–≤–Ω–µ)
  - –ù–∞–ª–æ–∂–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ —Å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏
- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–∏–¥–µ–æ –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π**
- **–ó–∞–≥—Ä—É–∑–∫–∞ –≤–∏–¥–µ–æ —Å YouTube** —á–µ—Ä–µ–∑ `yt-dlp`
- **–ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** ‚Äî —É–¥–æ–±–Ω–∞ –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
traffic-jam-analysis/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ detector.py         # YOLOv8 + ByteTrack
‚îÇ   ‚îú‚îÄ‚îÄ traffic_analyzer.py # –†–∞—Å—á—ë—Ç –º–µ—Ç—Ä–∏–∫ –∏ –±–∞–ª–ª–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ visualizer.py       # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –∏ –≥—Ä–∞—Ñ–∏–∫–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ processor.py        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∏–¥–µ–æ/–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ main.py             # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞, YouTube-–∑–∞–≥—Ä—É–∑–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ utils/              # –£—Ç–∏–ª–∏—Ç—ã (–ø–æ–∫–∞ –ø—É—Å—Ç–æ)
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îî‚îÄ‚îÄ sample_images/      # –í—Ö–æ–¥–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ output/                 # –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
‚îú‚îÄ‚îÄ results/
‚îÇ   ‚îú‚îÄ‚îÄ screenshots/        # –°–∫—Ä–∏–Ω—à–æ—Ç—ã –∞–Ω–∞–ª–∏–∑–∞
‚îÇ   ‚îú‚îÄ‚îÄ graphs/             # –ì—Ä–∞—Ñ–∏–∫–∏ –º–µ—Ç—Ä–∏–∫
‚îÇ   ‚îî‚îÄ‚îÄ logs/               # –õ–æ–≥-—Ñ–∞–π–ª—ã —Å –∫–∞–¥—Ä–∞–º–∏ –∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ LICENSE
‚îî‚îÄ‚îÄ .gitignore
```

---

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
git clone https://github.com/your-username/traffic-jam-analysis.git
cd traffic-jam-analysis
pip install -r requirements.txt
```

---

## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

- –î–æ–±–∞–≤—å—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –ø–∞–ø–∫—É `data/sample_images/`
- –î–ª—è —Ä–∞–±–æ—Ç—ã –∑–∞–≥—Ä—É–∑–∫–∏ –≤–∏–¥–µ–æ —Å YouTube –Ω–µ–æ–±—Ö–æ–¥–∏–º –¥–æ—Å—Ç—É–ø –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É

---

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

–ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ `src/main.py`:

```python
image_dir = "data/sample_images"
image_output_path = "output/output_traffic_images.mp4"
```

–ó–∞–ø—É—Å–∫:

```bash
python src/main.py
```

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –±—É–¥—É—Ç —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω—ã:

- –í–∏–¥–µ–æ —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π (`output/output_traffic_*.mp4`)
- –ì—Ä–∞—Ñ–∏–∫–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫ (`output/output_traffic_*_stats.png`)
- –õ–æ–≥–∏ –∞–Ω–∞–ª–∏–∑–∞ (`output/output_traffic_*.txt`)

---

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

–í –∫–∞—Ç–∞–ª–æ–≥–µ `results/` –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –ø—Ä–∏–º–µ—Ä—ã —Ä–µ–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã.

–ö–∞–∂–¥–æ–º—É –ø—Ä–∏–º–µ—Ä—É —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–∏ —Ñ–∞–π–ª–∞:
- **–°–∫—Ä–∏–Ω—à–æ—Ç** –∏–∑ –≤–∏–¥–µ–æ (–ø–∞–ø–∫–∞ `screenshots/`)
- **–ì—Ä–∞—Ñ–∏–∫ –º–µ—Ç—Ä–∏–∫ –≤–æ –≤—Ä–µ–º–µ–Ω–∏** (–ø–∞–ø–∫–∞ `graphs/`)
- **–õ–æ–≥-—Ñ–∞–π–ª** —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ –ø–æ –∫–∞–∂–¥–æ–º—É –∫–∞–¥—Ä—É (–ø–∞–ø–∫–∞ `logs/`)

–ß—Ç–æ –≤–∏–¥–Ω–æ –Ω–∞ –ø—Ä–∏–º–µ—Ä–∞—Ö:
- –°–∫—Ä–∏–Ω—à–æ—Ç—ã –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –¥–µ—Ç–µ–∫—Ü–∏—é –∏ —Ü–≤–µ—Ç–æ–≤—É—é —Ä–∞–∑–º–µ—Ç–∫—É –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –∫–∞–¥—Ä–µ, –∞ —Ç–∞–∫–∂–µ –Ω–∞–ª–æ–∂–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ —Å —Ç–µ–∫—É—â–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –º–µ—Ç—Ä–∏–∫.
- –ì—Ä–∞—Ñ–∏–∫–∏ –æ—Ç—Ä–∞–∂–∞—é—Ç –¥–∏–Ω–∞–º–∏–∫—É —Å–ª–µ–¥—É—é—â–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤: —Å—Ä–µ–¥–Ω—è—è —Å–∫–æ—Ä–æ—Å—Ç—å, –ø–ª–æ—Ç–Ω–æ—Å—Ç—å, –∏—Ç–æ–≥–æ–≤—ã–π –±–∞–ª–ª –ø–æ —à–∫–∞–ª–µ –ø—Ä–æ–±–∫–∏. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–∏–∑—É–∞–ª—å–Ω–æ –æ—Ü–µ–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å–∏—Ç—É–∞—Ü–∏–∏ –Ω–∞ –¥–æ—Ä–æ–≥–µ –≤–æ –≤—Ä–µ–º–µ–Ω–∏.
- –õ–æ–≥–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –∫–∞–∂–¥–æ–º—É –∫–∞–¥—Ä—É: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—à–∏–Ω, —Å—Ä–µ–¥–Ω—è—è —Å–∫–æ—Ä–æ—Å—Ç—å, –ø–ª–æ—Ç–Ω–æ—Å—Ç—å –∏ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–π –±–∞–ª–ª.

---

## üìä –ü—Ä–∏–º–µ—Ä—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

–ü—Ä–æ–µ–∫—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–±–æ–∫ –≤ –ø–∞–ø–∫–µ `results/`, –∫–æ—Ç–æ—Ä–∞—è –≤–∫–ª—é—á–∞–µ—Ç:

- `screenshots/` ‚Äî –∫–∞–¥—Ä—ã —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π –æ–±—ä–µ–∫—Ç–æ–≤ –∏ ROI  
- `logs/` ‚Äî —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –ª–æ–≥–∏ —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ –ø–æ –∫–∞–¥—Ä–∞–º  
- `graphs/` ‚Äî –≥—Ä–∞—Ñ–∏–∫–∏ —Å –¥–∏–Ω–∞–º–∏–∫–æ–π —Ç—Ä–∞—Ñ–∏–∫–∞ (–ø–ª–æ—Ç–Ω–æ—Å—Ç—å, —Å–∫–æ—Ä–æ—Å—Ç—å, –±–∞–ª–ª—ã)

### –í–∏–¥–µ–æ 1 ‚Äî –£–º–µ—Ä–µ–Ω–Ω–∞—è –ø—Ä–æ–±–∫–∞

![video_1](results/screenshots/video_1.png)

- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—à–∏–Ω**: –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 8‚Äì12  
- **–ü–ª–æ—Ç–Ω–æ—Å—Ç—å**: —Å—Ä–µ–¥–Ω—è—è  
- **–°–∫–æ—Ä–æ—Å—Ç—å**: –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–µ–Ω–Ω–æ –Ω–∏–∑–∫–∞—è  
- **–û—Ü–µ–Ω–∫–∞ —Ç—Ä–∞—Ñ–∏–∫–∞**: 4‚Äì6 –±–∞–ª–ª–æ–≤  
- **–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π**: –¥–≤–∏–∂–µ–Ω–∏–µ –∑–∞–º–µ–¥–ª–µ–Ω–æ, –≤–æ–∑–º–æ–∂–Ω—ã –ª–æ–∫–∞–ª—å–Ω—ã–µ –∑–∞—Ç–æ—Ä—ã

### –í–∏–¥–µ–æ 2 ‚Äî –°–≤–æ–±–æ–¥–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ

![video_2](results/screenshots/video_2.png)

- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—à–∏–Ω**: –Ω–µ–±–æ–ª—å—à–æ–µ  
- **–ü–ª–æ—Ç–Ω–æ—Å—Ç—å**: –Ω–∏–∑–∫–∞—è  
- **–°–∫–æ—Ä–æ—Å—Ç—å**: –≤—ã—Å–æ–∫–∞—è  
- **–û—Ü–µ–Ω–∫–∞ —Ç—Ä–∞—Ñ–∏–∫–∞**: 1‚Äì2 –±–∞–ª–ª–∞  
- **–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π**: –¥–≤–∏–∂–µ–Ω–∏–µ —Å–≤–æ–±–æ–¥–Ω–æ–µ, –ø—Ä–æ–±–æ–∫ –Ω–µ—Ç

### –í–∏–¥–µ–æ 3 ‚Äî –°–µ—Ä—å—ë–∑–Ω–∞—è –ø—Ä–æ–±–∫–∞

![video_3](results/screenshots/video_3.png)

- **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—à–∏–Ω**: –≤—ã—Å–æ–∫–æ–µ  
- **–ü–ª–æ—Ç–Ω–æ—Å—Ç—å**: –≤—ã—Å–æ–∫–∞—è  
- **–°–∫–æ—Ä–æ—Å—Ç—å**: –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω—É–ª–µ–≤–∞—è  
- **–û—Ü–µ–Ω–∫–∞ —Ç—Ä–∞—Ñ–∏–∫–∞**: 9‚Äì10 –±–∞–ª–ª–æ–≤

---

## –ù–∞—Å—Ç—Ä–æ–π–∫–∏

### –í–µ—Å–æ–≤—ã–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –º–µ—Ç—Ä–∏–∫ (–≤ `traffic_analyzer.py`):

```python
points = 10 * (
    0.4 * density_norm +
    0.2 * car_count_norm +
    0.2 * (1 - speed_norm) +
    0.1 * (1 - speed_var_norm) +
    0.1 * stationary_ratio
)
```

### –†–∞–∑–º–µ—Ä –æ–∫–Ω–∞ —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏—è:

```python
window_size = 100
```

### –û–±–ª–∞—Å—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å–∞ (ROI) –≤ –∫–∞–¥—Ä–µ (–≤ `processor.py`):

```python
roi = (10, 10, 630, 350)
```

### –ü—Ä–∏–º–µ—Ä—ã —Å—Å—ã–ª–æ–∫ –Ω–∞ YouTube (–≤ `main.py`):

```python
video_urls = [
    ("https://www.youtube.com/watch?v=zOq2XdwHGT0", "test_video_1.mp4"),
    ...
]
```

---

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–°–º. `requirements.txt`. –û—Å–Ω–æ–≤–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:

- Python 3.8+
- `opencv-python`
- `ultralytics` ‚Äî –¥–ª—è YOLOv8
- `matplotlib`
- `lap`
- `numpy`
- `yt-dlp`

–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π:

```bash
pip install -r requirements.txt
```

---

## –õ–∏—Ü–µ–Ω–∑–∏—è

–ü—Ä–æ–µ–∫—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–¥ –ª–∏—Ü–µ–Ω–∑–∏–µ–π MIT. –°–º. —Ñ–∞–π–ª [LICENSE](./LICENSE).